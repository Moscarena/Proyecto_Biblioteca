<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup</title>
    <link rel="icon" type="img/png" href="../img/ccicon.ico">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/signup.css">
    <link rel="stylesheet" href="../css/footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
    <header>
        <h1 class="animate__animated animate__fadeInTopLeft">Formulario de Registro</h1>
    </header>
    <nav>
        <a href="../Index.html">Home</a>
        <a href="login.html">Login</a>
    </nav>
    <div class="container">
        <form id="registroForm" action="./login.html" method="get" onsubmit="return validarFormulario()">
            <div class="form-group">
                <label for="nombre">Nombre:</label>
                <input type="text" id="nombre" name="nombre" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="apellido">Apellido:</label>
                <input type="text" id="apellido" name="apellido" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="fecha_nacimiento">Fecha de Nacimiento:</label>
                <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label>Género:</label><br>
                <div class="gender-options">
                    <div class="gender-option femenino-option">
                        <input type="radio" id="femenino" name="genero" value="femenino" required>
                        <label for="femenino" class="gender-label">
                            <span class="gender-text">Femenino</span>
                            <i class="fa-solid fa-child-dress fa-flip icono-svg" style="color: #efafe9;"></i>
                        </label>
                    </div>
                    <div class="gender-option masculino-option">
                        <input type="radio" id="masculino" name="genero" value="masculino" required>
                        <label for="masculino" class="gender-label">
                            <span class="gender-text">Masculino</span>
                            <i class="fa-solid fa-child fa-flip icono-svg" style="color: #74C0FC;"></i>
                        </label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="pais">País:</label>
                <select id="pais" name="pais" onchange="mostrarOtroPais(this.value)" required
                    oninput="limpiarAlerta(this)">
                    <option value="">Selecciona tu país</option>
                    <option value="ARG">Argentina</option>
                    <option value="BOL">Bolivia</option>
                    <option value="BRA">Brasil</option>
                    <option value="CAN">Canadá</option>
                    <option value="CHL">Chile</option>
                    <option value="COL">Colombia</option>
                    <option value="CRI">Costa Rica</option>
                    <option value="CUB">Cuba</option>
                    <option value="DOM">República Dominicana</option>
                    <option value="ECU">Ecuador</option>
                    <option value="SLV">El Salvador</option>
                    <option value="GTM">Guatemala</option>
                    <option value="HTI">Haití</option>
                    <option value="HND">Honduras</option>
                    <option value="MEX">México</option>
                    <option value="NIC">Nicaragua</option>
                    <option value="PAN">Panamá</option>
                    <option value="PRY">Paraguay</option>
                    <option value="PER">Perú</option>
                    <option value="USA">Estados Unidos</option>
                    <option value="URY">Uruguay</option>
                    <option value="VEN">Venezuela</option>
                    <option value="OTRO">Otro</option>
                </select>
            </div>
            <div class="form-group" id="otroPaisGroup" style="display: none;">
                <label for="otro_pais">Ingresa tu País:</label>
                <input type="text" id="otro_pais" name="otro_pais" oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="password">Contraseña:</label>
                <input type="password" id="password" name="password" required oninput="limpiarAlerta(this)">
            </div>
            <div class="form-group">
                <label for="confirm_password">Repetir Contraseña:</label>
                <input type="password" id="confirm_password" name="confirm_password" required
                    oninput="limpiarAlerta(this)">
            </div>
            <button type="button" onclick="enviarFormulario()">Enviar</button>
        </form>
    </div>

    <footer>
        <div class="footer-content">
            <img class="imgfooter" src="../img/cc2.png" alt="">
            <div class="footer-text">
                <span>The CodersCrusaders:</span>
                <p>Monica Carena, Flavio Ramires, Cesar Torres, Roberto Steklein</p>
                <p>&copy; 2024 Biblioteca para Niños - Todos los derechos reservados</p>
            </div>
        </div>
    </footer>

</body>


<script>
    function mostrarAlerta(mensaje, campo) {
        var alerta = document.createElement("div");
        alerta.className = "alerta";
        alerta.textContent = mensaje;

        campo.classList.add("error");
        campo.parentNode.insertBefore(alerta, campo.nextSibling);
    }

    function limpiarAlerta(campo) {
        campo.classList.remove("error");
        var alerta = campo.parentNode.querySelector(".alerta");
        if (alerta) {
            alerta.parentNode.removeChild(alerta);
        }
    }

    function validarFormulario() {
        var campos = document.querySelectorAll('input[required], select[required]');
        var valido = true;

        campos.forEach(function (campo) {
            if (!campo.value.trim()) {
                mostrarAlerta("Falta completar este campo", campo);
                valido = false;
            }
        });

        var paisSeleccionado = document.getElementById("pais").value;
        var otroPais = document.getElementById("otro_pais").value;

        if (paisSeleccionado === "OTRO" && otroPais.trim() === "") {
            mostrarAlerta("Por favor ingresa tu país", document.getElementById("otro_pais"));
            valido = false;
        }

        var email = document.getElementById("email").value;
        var username = document.getElementById("username").value;

        var emailsRegistrados = ["usuario1@example.com", "usuario2@example.com"];
        var usernamesRegistrados = ["usuario1", "usuario2"];

        if (emailsRegistrados.includes(email)) {
            var campoEmail = document.getElementById("email");
            mostrarAlerta("Este E-mail ya está registrado", campoEmail);
            valido = false;
        }

        if (usernamesRegistrados.includes(username)) {
            var campoUsername = document.getElementById("username");
            mostrarAlerta("Este nombre de usuario no está disponible, por favor elige otro", campoUsername);
            valido = false;
        }

        if (!validarContraseñas()) {
            valido = false;
        }

        return valido;
    }

    function validarContraseñas() {
        var password = document.getElementById("password").value;
        var confirmarPassword = document.getElementById("confirm_password").value;

        if (!validarFormatoContraseña(password)) {
            var campoPassword = document.getElementById("password");
            mostrarAlerta("La contraseña debe tener al menos 8 caracteres, contar con al menos una mayúscula, una minúscula, un número y un caracter especial", campoPassword);
            return false;
        }

        if (password !== confirmarPassword) {
            var campoConfirmPassword = document.getElementById("confirm_password");
            mostrarAlerta("Las contraseñas no coinciden", campoConfirmPassword);
            return false;
        }

        return true;
    }

    function validarFormatoContraseña(password) {
        var regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        return regex.test(password);
    }
</script>

<script>
    function mostrarOtroPais(valor) {
        var otroPaisGroup = document.getElementById("otroPaisGroup");
        if (valor === "OTRO") {
            otroPaisGroup.style.display = "block";
        } else {
            otroPaisGroup.style.display = "none";
        }
    }
</script>

<script>
    function enviarFormulario() {
        var formularioValido = validarFormulario();
        if (formularioValido) {
            document.getElementById("registroForm").action = "../templates/login.html";
            document.getElementById("registroForm").submit();
        }
    }
</script>
</body>

</html>